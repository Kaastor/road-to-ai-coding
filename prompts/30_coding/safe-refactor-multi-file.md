Refactor <module> for clarity and testability without changing behavior.

- Show a safety plan (tests to pin behavior).
- Propose a new structure (functions/classes, file layout).
- Apply changes incrementally with commit-sized patches.
- Run through a checklist: naming, cohesion, dead code, logging.
